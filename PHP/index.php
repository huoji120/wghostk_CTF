<p>第一关:学会百度</p>
<p>-你连百度都不会,你学什么黑客?</p>
<link rel='stylesheet' type='text/css' href='https://cdn.bootcss.com/SyntaxHighlighter/3.0.83/styles/shCoreRDark.css'/>
<div class="syntaxhighlighter  php" id="highlighter_629092"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php functions">ini_set</code><code class="php plain">(</code><code class="php string">"display_errors"</code><code class="php plain">,0);</code></div><div class="line number2 index1 alt1"><code class="php keyword">if</code><code class="php plain">(isset(</code><code class="php variable">$_GET</code><code class="php plain">[</code><code class="php string">'flag'</code><code class="php plain">])&nbsp;&amp;&amp;&nbsp;</code><code class="php variable">$_GET</code><code class="php plain">[</code><code class="php string">'flag'</code><code class="php plain">])</code></div><div class="line number3 index2 alt2"><code class="php plain">{</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code><code class="php plain">(</code><code class="php variable">$_GET</code><code class="php plain">[</code><code class="php string">'flag'</code><code class="php plain">]&nbsp;===&nbsp;</code><code class="php string">"flag{**********************************}"</code><code class="php plain">)</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code>&nbsp;<code class="php string">"下一个Flag文件地址(Next&nbsp;Flag&nbsp;File)"</code><code class="php plain">;</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">else</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code>&nbsp;<code class="php string">"404"</code><code class="php plain">;</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">();</code></div><div class="line number9 index8 alt2"><code class="php plain">}</code></div><div class="line number10 index9 alt1"><code class="php variable">$uri</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php variable">$_SERVER</code><code class="php plain">[</code><code class="php string">'REQUEST_URI'</code><code class="php plain">];</code></div><div class="line number11 index10 alt2"><code class="php keyword">if</code><code class="php plain">(</code><code class="php functions">stripos</code><code class="php plain">(</code><code class="php variable">$uri</code><code class="php plain">,</code><code class="php string">"."</code><code class="php plain">)){</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">(</code><code class="php string">"wtf"</code><code class="php plain">);</code></div><div class="line number13 index12 alt2"><code class="php plain">}</code></div><div class="line number14 index13 alt1"><code class="php keyword">if</code><code class="php plain">(!</code><code class="php functions">parse_url</code><code class="php plain">(</code><code class="php variable">$uri</code><code class="php plain">,PHP_URL_HOST)){</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$uri</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php string">"<a href="http://">http://</a>"</code><code class="php plain">.</code><code class="php variable">$_SERVER</code><code class="php plain">[</code><code class="php string">'REMOTE_ADDR'</code><code class="php plain">].</code><code class="php variable">$_SERVER</code><code class="php plain">[</code><code class="php string">'REQUEST_URI'</code><code class="php plain">];</code></div><div class="line number16 index15 alt1"><code class="php plain">}</code></div><div class="line number17 index16 alt2"><code class="php variable">$host</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">parse_url</code><code class="php plain">(</code><code class="php variable">$uri</code><code class="php plain">,PHP_URL_HOST);</code></div><div class="line number18 index17 alt1"><code class="php keyword">if</code><code class="php plain">(</code><code class="php variable">$host</code>&nbsp;<code class="php plain">===&nbsp;</code><code class="php string">"ctf.wghostk.com"</code><code class="php plain">){</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">setcookie(</code><code class="php string">"AuthFlag"</code><code class="php plain">,</code><code class="php string">"flag{********************************}"</code><code class="php plain">);</code></div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code>&nbsp;<code class="php string">"What?"</code><code class="php plain">;</code></div><div class="line number21 index20 alt2"><code class="php plain">}</code></div></div></td></tr></tbody></table></div>
<?php
ini_set("display_errors",0);
if(isset($_GET['flag']) && $_GET['flag'])
{
	if($_GET['flag'] === "flag{OK_NOW_YOU_KNOW_HOW_TO_US_BAIDU}")
		echo "Next: php_theduck_ass1.php";
	else
		echo "404";
	die();
}
$uri = $_SERVER['REQUEST_URI'];
if(stripos($uri,".")){
    die("人是一种很神奇的动物,有些人喜欢耍嘴皮子说着我爱你,我喜欢你,你好漂亮.而女生则最喜欢这种懂'情话'的情商高到爆炸的男生,殊不知真正喜欢你的人情商可能很低,因为都把提升情商的时间拿去提升自己的能力了.");
}
if(!parse_url($uri,PHP_URL_HOST)){
    $uri = "http://".$_SERVER['REMOTE_ADDR'].$_SERVER['REQUEST_URI'];
	var_dump($uri);
}
$host = parse_url($uri,PHP_URL_HOST);
if($host === "ctf.wghostk.com"){
    setcookie("AuthFlag","flag{OK_NOW_YOU_KNOW_HOW_TO_US_BAIDU}");
	echo "What?";
}
?>